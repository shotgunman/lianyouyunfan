<!doctype html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="initial-scale=1.0, user-scalable=yes, width=device-width">
  <title></title>
  <link rel="stylesheet" href="https://a.amap.com/jsapi_demos/static/demo-center/css/demo-center.css" />

  <style>
    html,
    body,
    #container {
      height: 100%;
      width: 100%;
    }
    </style>
</head>

<body>
  <button onclick="updatePoints()">更新点</button>

  <div id="container"></div>
<!--  <div id="my-panel"></div>-->
  <script type="text/javascript">
<!--    这里最好设置反代-->
    window._AMapSecurityConfig = {
      securityJsCode: "你的安全密钥",
    };
  </script>
  <script src="https://webapi.amap.com/loader.js"></script>
  <script type="text/javascript">

    var map, driving;

    AMapLoader.load({
      key: "你的JSKEY",
      version: "2.0", //指定要加载的 JS API 的版本，缺省时默认为 1.4.15
    })
      .then((AMap) => {
          map = new AMap.Map("container", {
            zoom:11,  //初始化地图层

        })

      AMap.plugin("AMap.Driving", function () {
            driving = new AMap.Driving({
              policy: 0, //驾车路线规划策略，0是速度优先的策略
              //map 指定将路线规划方案绘制到对应的 AMap.Map 对象上
              map: map,
              // panel 指定将结构化的路线详情数据显示的对应的DOM上，传入值需是DOM的ID
              // panel: 'my-panel',
          });

          driving.search([116.482086, 33.990496], [116.397455,39.909187],{waypoints: [[116.397455,39.909187]],});

        });

      })
      .catch((e) => {
        console.error(e); //加载错误提示
      });
  </script>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>

        function updatePoints() {
            $.ajax({
                url: 'http://127.0.0.1:5000/get_data',  // Flask 服务器端点
                type: 'GET',
                success: function(response) {
                    var sted = response.sted;
                    var opts = response.opts;

                    if (sted.length >= 2) {
                        driving.search(sted[0], sted[1], opts);
                    }

                }
            });
        }
    </script>
</body>

</html>